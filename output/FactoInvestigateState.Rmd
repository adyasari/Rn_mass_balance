---
title: "Principal Component Analysis"
author: "Dataset dat3"
output:
  pdf_document: default
---
This dataset contains 17726 individuals and 17 variables.

- - -

```{r, echo = FALSE}
library(FactoMineR)
load('/Users/peterfuleky/Documents/UHERO/UHERO_work/forecast/Rn_mass_balance/Workspace.RData')
```
### 1. Study of the outliers
The analysis of the graphs does not detect any outlier.

- - -

### 2. Inertia distribution
The inertia of the first dimensions shows if there are strong relationships between variables and suggests the number of dimensions that should be studied.

The first two dimensions of analyse express **54.24%** of the total dataset inertia ; that means that 54.24% of the individuals (or variables) cloud total variability is explained by the plane.
This percentage is relatively high and thus the first plane well represents the data variability.
This value is strongly greater than the reference value that equals **12.41%**, the variability explained by this plane is thus highly significant
(the reference value is the 0.95-quantile of the inertia percentages distribution obtained by simulating 326 data tables of equivalent size on the basis of a normal distribution).

From these observations, it should be better to also interpret the dimensions greater or equal to the third one.

```{r, echo = FALSE, fig.align = 'center', fig.height = 3.5, fig.width = 5.5}
par(mar = c(2.6, 4.1, 1.1, 2.1))
ggplot2::ggplot(cbind.data.frame(x=1:nrow(res$eig),y=res$eig[,2])) + ggplot2::aes(x=x, y=y)+ ggplot2::geom_col(fill="blue") + ggplot2::xlab("Dimension") + ggplot2::ylab("Percentage of variance") + ggplot2::ggtitle("Decomposition of the total inertia") + ggplot2::theme_light() + ggplot2::theme(plot.title = ggplot2::element_text(hjust =0.5)) + ggplot2::scale_x_continuous(breaks=1:nrow(res$eig))
```

**Figure 2 - Decomposition of the total inertia**

An estimation of the right number of axis to interpret suggests to restrict the analysis to the description of the first 5 axis.
These axis present an amount of inertia greater than those obtained by the 0.95-quantile of random distributions (84.37% against 30.61%).
This observation suggests that only these axis are carrying a real information.
As a consequence, the description will stand to these axis.

- - -

### 3. Description of the plane 1:2

```{r, echo = FALSE, fig.align = 'center', fig.height = 3.5, fig.width = 5.5}
drawn <-
integer(0)
par(mar = c(4.1, 4.1, 1.1, 2.1))
plot.PCA(res, select = drawn, axes = c(1,2), choix = 'ind', invisible = 'quali', title = '', cex = cex)
```

**Figure 3.1 - Individuals factor map (PCA)**
*The labeled individuals are those with the higher contribution to the plane construction.*

```{r, echo = FALSE, fig.align = 'center', fig.height = 3.5, fig.width = 5.5}
drawn <-
c("kw_air", "temp_wat__C", "temp_wat__K", "f_Rn_net__Bqm2hr", 
"ex_Rn_wat__Bqm3", "Rn_wat__Bqm3", "ex_Rn_wat_inv__Bqm2", "f_Rn_gross__Bqm2hr", 
"sal_wat", "f_mix__Bqm2hr", "f_atm__Bqm2hr")
par(mar = c(4.1, 4.1, 1.1, 2.1))
plot.PCA(res, select = drawn, axes = 1:2, choix = 'var', title = '', cex = cex)
```

**Figure 3.2 - Variables factor map (PCA)**
*The labeled variables are those the best shown on the plane.*

* * *

The **dimension 1** opposes individuals characterized by a strongly positive coordinate on the axis (to the right of the graph)
to individuals characterized by a strongly negative coordinate on the axis (to the left of the graph).

The group 1 (characterized by a positive coordinate on the axis) is sharing :

- high values for variables like *temp_wat__K*, *temp_wat__C*, *sal_wat*, *ex_Rn_wat_inv__Bqm2*, *f_Rn_flood__Bqm2hr*, *f_atm__Bqm2hr*, *ex_Rn_wat__Bqm3*, *Rn_wat__Bqm3*, *f_Rn_gross__Bqm2hr* and *f_Rn_net__Bqm2hr* (variables are sorted from the strongest).
- low values for the variables *kw_air*, *f_mix__Bqm2hr*, *f_Rn_ebb__Bqm2hr*, *f_gw__m3m2d* and *f_Rn_total__Bqm2hr* (variables are sorted from the weakest).

The group 2 (characterized by a positive coordinate on the axis) is sharing :

- high values for the variables *kw_air*, *f_Rn_ebb__Bqm2hr*, *f_Rn_net__Bqm2hr*, *f_Rn_gross__Bqm2hr*, *ex_Rn_wat__Bqm3*, *Rn_wat__Bqm3*, *f_Rn_total__Bqm2hr*, *f_gw__m3m2d*, *f_atm__Bqm2hr* and *ex_Rn_wat_inv__Bqm2* (variables are sorted from the strongest).
- low values for the variables *temp_wat__C*, *temp_wat__K*, *sal_wat*, *depth__m*, *f_mix__Bqm2hr*, *f_Rn_flood__Bqm2hr* and *wind__ms* (variables are sorted from the weakest).

The group 3 (characterized by a negative coordinate on the axis) is sharing :

- high values for the variables *f_mix__Bqm2hr*, *depth__m* and *kw_air* (variables are sorted from the strongest).
- low values for variables like *ex_Rn_wat_inv__Bqm2*, *Rn_wat__Bqm3*, *ex_Rn_wat__Bqm3*, *f_atm__Bqm2hr*, *f_Rn_net__Bqm2hr*, *f_Rn_gross__Bqm2hr*, *f_Rn_ebb__Bqm2hr*, *f_Rn_total__Bqm2hr*, *f_gw__m3m2d* and *sal_wat* (variables are sorted from the weakest).


* * *

The **dimension 2** opposes individuals characterized by a strongly positive coordinate on the axis (to the top of the graph)
to individuals characterized by a strongly negative coordinate on the axis (to the bottom of the graph).

The group 1 (characterized by a positive coordinate on the axis) is sharing :

- high values for variables like *temp_wat__K*, *temp_wat__C*, *sal_wat*, *ex_Rn_wat_inv__Bqm2*, *f_Rn_flood__Bqm2hr*, *f_atm__Bqm2hr*, *ex_Rn_wat__Bqm3*, *Rn_wat__Bqm3*, *f_Rn_gross__Bqm2hr* and *f_Rn_net__Bqm2hr* (variables are sorted from the strongest).
- low values for the variables *kw_air*, *f_mix__Bqm2hr*, *f_Rn_ebb__Bqm2hr*, *f_gw__m3m2d* and *f_Rn_total__Bqm2hr* (variables are sorted from the weakest).

The group 2 (characterized by a negative coordinate on the axis) is sharing :

- high values for the variables *f_mix__Bqm2hr*, *depth__m* and *kw_air* (variables are sorted from the strongest).
- low values for variables like *ex_Rn_wat_inv__Bqm2*, *Rn_wat__Bqm3*, *ex_Rn_wat__Bqm3*, *f_atm__Bqm2hr*, *f_Rn_net__Bqm2hr*, *f_Rn_gross__Bqm2hr*, *f_Rn_ebb__Bqm2hr*, *f_Rn_total__Bqm2hr*, *f_gw__m3m2d* and *sal_wat* (variables are sorted from the weakest).

The group 3 (characterized by a negative coordinate on the axis) is sharing :

- high values for the variables *kw_air*, *f_Rn_ebb__Bqm2hr*, *f_Rn_net__Bqm2hr*, *f_Rn_gross__Bqm2hr*, *ex_Rn_wat__Bqm3*, *Rn_wat__Bqm3*, *f_Rn_total__Bqm2hr*, *f_gw__m3m2d*, *f_atm__Bqm2hr* and *ex_Rn_wat_inv__Bqm2* (variables are sorted from the strongest).
- low values for the variables *temp_wat__C*, *temp_wat__K*, *sal_wat*, *depth__m*, *f_mix__Bqm2hr*, *f_Rn_flood__Bqm2hr* and *wind__ms* (variables are sorted from the weakest).

Note that the variable *kw_air* is highly correlated with this dimension (correlation of 0.05). This variable could therefore summarize itself the dimension 2.

- - -

### 4. Description of the plane 3:4

```{r, echo = FALSE, fig.align = 'center', fig.height = 3.5, fig.width = 5.5}
drawn <-
integer(0)
par(mar = c(4.1, 4.1, 1.1, 2.1))
plot.PCA(res, select = drawn, axes = c(3,4), choix = 'ind', invisible = 'quali', title = '', cex = cex)
```

**Figure 4.1 - Individuals factor map (PCA)**
*The labeled individuals are those with the higher contribution to the plane construction.*

```{r, echo = FALSE, fig.align = 'center', fig.height = 3.5, fig.width = 5.5}
drawn <-
c("f_Rn_flood__Bqm2hr", "f_Rn_total__Bqm2hr", "f_gw__m3m2d", 
"f_Rn_ebb__Bqm2hr", "depth__m", "ex_Rn_wat__Bqm3")
par(mar = c(4.1, 4.1, 1.1, 2.1))
plot.PCA(res, select = drawn, axes = 3:4, choix = 'var', title = '', cex = cex)
```

**Figure 4.2 - Variables factor map (PCA)**
*The labeled variables are those the best shown on the plane.*

* * *

The **dimension 3** opposes individuals characterized by a strongly positive coordinate on the axis (to the right of the graph)
to individuals characterized by a strongly negative coordinate on the axis (to the left of the graph).

The group 1 (characterized by a positive coordinate on the axis) is sharing :

- high values for the variables *f_Rn_gross__Bqm2hr*, *f_gw__m3m2d*, *f_Rn_total__Bqm2hr*, *f_Rn_net__Bqm2hr*, *depth__m*, *temp_wat__K*, *temp_wat__C* and *sal_wat* (variables are sorted from the strongest).
- low values for the variables *Rn_wat__Bqm3*, *ex_Rn_wat__Bqm3*, *ex_Rn_wat_inv__Bqm2*, *f_mix__Bqm2hr*, *f_atm__Bqm2hr*, *f_Rn_flood__Bqm2hr*, *kw_air* and *wind__ms* (variables are sorted from the weakest).

The group 2 (characterized by a negative coordinate on the axis) is sharing :

- high values for the variables *f_Rn_flood__Bqm2hr*, *ex_Rn_wat_inv__Bqm2*, *f_mix__Bqm2hr*, *ex_Rn_wat__Bqm3*, *Rn_wat__Bqm3*, *kw_air*, *f_atm__Bqm2hr* and *depth__m* (variables are sorted from the strongest).
- low values for the variables *f_Rn_ebb__Bqm2hr*, *f_Rn_net__Bqm2hr*, *f_Rn_gross__Bqm2hr*, *f_Rn_total__Bqm2hr*, *f_gw__m3m2d*, *temp_wat__C*, *temp_wat__K*, *sal_wat* and *wind__ms* (variables are sorted from the weakest).

The group 3 (characterized by a negative coordinate on the axis) is sharing :

- high values for the variables *f_Rn_ebb__Bqm2hr*, *f_atm__Bqm2hr*, *ex_Rn_wat__Bqm3*, *Rn_wat__Bqm3*, *wind__ms*, *sal_wat*, *temp_wat__C*, *temp_wat__K* and *f_mix__Bqm2hr* (variables are sorted from the strongest).
- low values for the variables *depth__m*, *f_Rn_flood__Bqm2hr*, *f_Rn_total__Bqm2hr*, *f_gw__m3m2d*, *f_Rn_gross__Bqm2hr*, *f_Rn_net__Bqm2hr* and *kw_air* (variables are sorted from the weakest).


* * *

The **dimension 4** opposes individuals characterized by a strongly positive coordinate on the axis (to the top of the graph)
to individuals characterized by a strongly negative coordinate on the axis (to the bottom of the graph).

The group 1 (characterized by a positive coordinate on the axis) is sharing :

- high values for the variables *f_Rn_flood__Bqm2hr*, *ex_Rn_wat_inv__Bqm2*, *f_mix__Bqm2hr*, *ex_Rn_wat__Bqm3*, *Rn_wat__Bqm3*, *kw_air*, *f_atm__Bqm2hr* and *depth__m* (variables are sorted from the strongest).
- low values for the variables *f_Rn_ebb__Bqm2hr*, *f_Rn_net__Bqm2hr*, *f_Rn_gross__Bqm2hr*, *f_Rn_total__Bqm2hr*, *f_gw__m3m2d*, *temp_wat__C*, *temp_wat__K*, *sal_wat* and *wind__ms* (variables are sorted from the weakest).

The group 2 (characterized by a negative coordinate on the axis) is sharing :

- high values for the variables *f_Rn_ebb__Bqm2hr*, *f_atm__Bqm2hr*, *ex_Rn_wat__Bqm3*, *Rn_wat__Bqm3*, *wind__ms*, *sal_wat*, *temp_wat__C*, *temp_wat__K* and *f_mix__Bqm2hr* (variables are sorted from the strongest).
- low values for the variables *depth__m*, *f_Rn_flood__Bqm2hr*, *f_Rn_total__Bqm2hr*, *f_gw__m3m2d*, *f_Rn_gross__Bqm2hr*, *f_Rn_net__Bqm2hr* and *kw_air* (variables are sorted from the weakest).


- - -

### 5. Description of the dimension 5

```{r, echo = FALSE, fig.align = 'center', fig.height = 3.5, fig.width = 5.5}
drawn <-
integer(0)
par(mar = c(4.1, 4.1, 1.1, 2.1))
plot.PCA(res, select = drawn, axes = c(5,6), choix = 'ind', invisible = 'quali', title = '', cex = cex)
```

**Figure 5.1 - Individuals factor map (PCA)**
*The labeled individuals are those with the higher contribution to the plane construction.*

```{r, echo = FALSE, fig.align = 'center', fig.height = 3.5, fig.width = 5.5}
drawn <-
c("wind__ms", "f_mix__Bqm2hr", "f_Rn_ebb__Bqm2hr", "f_Rn_total__Bqm2hr", 
"f_gw__m3m2d", "f_atm__Bqm2hr")
par(mar = c(4.1, 4.1, 1.1, 2.1))
plot.PCA(res, select = drawn, axes = 5:6, choix = 'var', title = '', cex = cex)
```

**Figure 5.2 - Variables factor map (PCA)**
*The labeled variables are those the best shown on the plane.*

* * *

The **dimension 5** opposes individuals characterized by a strongly positive coordinate on the axis (to the right of the graph)
to individuals characterized by a strongly negative coordinate on the axis (to the left of the graph).

The group 1 (characterized by a positive coordinate on the axis) is sharing :

- high values for the variables *f_mix__Bqm2hr*, *f_Rn_ebb__Bqm2hr*, *depth__m*, *f_gw__m3m2d*, *f_Rn_total__Bqm2hr*, *ex_Rn_wat_inv__Bqm2* and *kw_air* (variables are sorted from the strongest).
- low values for the variables *f_Rn_gross__Bqm2hr*, *f_Rn_net__Bqm2hr*, *f_Rn_flood__Bqm2hr*, *temp_wat__C*, *temp_wat__K* and *wind__ms* (variables are sorted from the weakest).

The group 2 (characterized by a positive coordinate on the axis) is sharing :

- high values for the variables *wind__ms*, *f_atm__Bqm2hr*, *sal_wat*, *f_Rn_gross__Bqm2hr*, *f_Rn_net__Bqm2hr*, *f_Rn_flood__Bqm2hr*, *f_Rn_total__Bqm2hr*, *f_gw__m3m2d* and *kw_air* (variables are sorted from the strongest).
- low values for the variables *ex_Rn_wat_inv__Bqm2*, *Rn_wat__Bqm3*, *ex_Rn_wat__Bqm3*, *temp_wat__K*, *temp_wat__C*, *f_Rn_ebb__Bqm2hr* and *f_mix__Bqm2hr* (variables are sorted from the weakest).

The group 3 (characterized by a negative coordinate on the axis) is sharing :

- high values for the variables *f_Rn_gross__Bqm2hr*, *f_Rn_net__Bqm2hr*, *temp_wat__K*, *temp_wat__C*, *ex_Rn_wat__Bqm3*, *Rn_wat__Bqm3* and *ex_Rn_wat_inv__Bqm2* (variables are sorted from the strongest).
- low values for the variables *wind__ms*, *f_mix__Bqm2hr*, *f_atm__Bqm2hr*, *depth__m*, *sal_wat*, *f_gw__m3m2d*, *f_Rn_total__Bqm2hr*, *kw_air* and *f_Rn_ebb__Bqm2hr* (variables are sorted from the weakest).

Note that the variable *wind__ms* is highly correlated with this dimension (correlation of 0). This variable could therefore summarize itself the dimension 5.

- - -

### 6. Classification

The dataset is too large to perform the classification.

- - -

## Annexes

